static-analysis:
  runs-on: ubuntu-latest
  needs: build
  defaults:
    run:
      working-directory: ./example-app

  steps:
    - name: 🛠️ Checkout repository
      uses: actions/checkout@v4

    - name: 🗂️ Restore cached dependencies
      uses: actions/cache@v3
      with:
        path: ./example-app/.venv
        key: ${{ runner.os }}-venv-${{ hashFiles('**/poetry.lock') }}

    - name: 🔄 Activate Poetry Environment
      run: poetry env use python3.11

    - name: 🛡️ Run lint
      run: poetry run task lint

    - name: 🎨 Run formatter
      run: poetry run task formatter

    - name: 🔒 Run security checks
      run: poetry run task security


unittest:
  runs-on: ubuntu-latest
  needs: build
  defaults:
    run:
      working-directory: ./example-app

  steps:
    - name: 🛠️ Checkout repository
      uses: actions/checkout@v4

    - name: 🗂️ Restore cached dependencies
      uses: actions/cache@v3
      with:
        path: ./example-app/.venv
        key: ${{ runner.os }}-venv-${{ hashFiles('**/poetry.lock') }}

    - name: 🔄 Activate Poetry Environment
      run: poetry env use python3.11

    - name: 🧪 Run unit tests
      run: poetry run task test

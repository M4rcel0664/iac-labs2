static-analysis:
  runs-on: ubuntu-latest
  needs: build
  defaults:
    run:
      working-directory: ./example-app

  steps:
    - name: ğŸ› ï¸ Checkout repository
      uses: actions/checkout@v4

    - name: ğŸ—‚ï¸ Restore cached dependencies
      uses: actions/cache@v3
      with:
        path: ./example-app/.venv
        key: ${{ runner.os }}-venv-${{ hashFiles('**/poetry.lock') }}

    - name: ğŸ”„ Activate Poetry Environment
      run: poetry env use python3.11

    - name: ğŸ›¡ï¸ Run lint
      run: poetry run task lint

    - name: ğŸ¨ Run formatter
      run: poetry run task formatter

    - name: ğŸ”’ Run security checks
      run: poetry run task security


unittest:
  runs-on: ubuntu-latest
  needs: build
  defaults:
    run:
      working-directory: ./example-app

  steps:
    - name: ğŸ› ï¸ Checkout repository
      uses: actions/checkout@v4

    - name: ğŸ—‚ï¸ Restore cached dependencies
      uses: actions/cache@v3
      with:
        path: ./example-app/.venv
        key: ${{ runner.os }}-venv-${{ hashFiles('**/poetry.lock') }}

    - name: ğŸ”„ Activate Poetry Environment
      run: poetry env use python3.11

    - name: ğŸ§ª Run unit tests
      run: poetry run task test
